---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Footer from '../../components/Footer.astro';
import Form from '../../components/Form.astro';

export async function getStaticPaths() {
  const blogEntries = await getCollection('blog');
  return blogEntries.map(entry => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content, headings } = await entry.render();
const pageTitle = `${entry.data.title} | Blog - Çitlembik Dekorasyon`;
---
<style>
    
</style>
<Layout title={pageTitle} description={entry.data.description} image={entry.data.heroImage}>
  <main class="pt-20">
    <article>
      <!-- Hero Section -->
      <section class="relative py-24 md:py-32 bg-cover bg-center" style={`background-image: url(${entry.data.heroImage})`}>
        <div class="absolute inset-0 bg-black/60"></div>
        <div class="relative container mx-auto px-4 text-center text-white">
          <h1 class="text-4xl md:text-6xl font-bold mb-4">{entry.data.title}</h1>
          <div class="flex items-center justify-center text-sm text-gray-300">
            <span>{entry.data.pubDate.toLocaleDateString('tr-TR', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
            <span class="mx-2">•</span>
            <span>{entry.data.readTime}</span>
          </div>
            <div class="text-white">
                        <a href="/"><span class="hover:underline">Anasayfa</span></a>
                        <span class="mx-1">/</span>
                        <a href="/blog"> <span class="hover:underline">Blog</span></a>
                        <span class="mx-1">/</span>
                        <span class="hover:underline">{entry.data.title}</span>
                    </div>
        </div>
      </section>
      <section class="bg-gray-100 py-10">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-bold text-center mb-8">İçerik Başlıkları</h2>
            <ul class="max-w-2xl mx-auto list-disc list-inside space-y-2">
                {headings.map(heading => (
                    <li class={`ml-${(heading.depth - 2) * 4}`}>
                        <a href={`#${heading.slug}`} class="text-blue-600 hover:underline">
                            {heading.text}
                        </a>
                    </li>
                ))}
            </ul>
        </div>
    </section> 

      <!-- Content Section -->
      <section class="py-16 md:py-24 bg-white">
        <div class="container mx-auto px-4">
          <div id="content" class="max-w-4xl mx-auto prose-a:text-blue-600 hover:prose-a:text-blue-800 prose-img:rounded-xl prose-img:shadow-lg prose-h1:text-4xl prose-h2:text-3xl prose-h3:text-2xl prose-h1:mb-6 prose-h2:mb-5 prose-h3:mb-4">
            <Content />
          </div>
        </div>
      </section>
    </article>

    <Form />
  </main>
  <Footer />
</Layout>

<script>
document.addEventListener("DOMContentLoaded",function(){
    let cont = document.querySelectorAll("p");
    let head = document.querySelectorAll("h3")
    cont.forEach(p => {
        p.classList.add("text-lg", "lg:text-2xl", "leading-relaxed");
    })
    head.forEach(p => {
        p.classList.add("font-bold", "tracking-wide", "text-gray-900", "mt-10", "mb-6", "text-2xl", "lg:text-4xl")
    })
})
</script>
